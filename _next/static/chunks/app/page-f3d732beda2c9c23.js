(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9562:(e,t,a)=>{Promise.resolve().then(a.bind(a,753))},753:(e,t,a)=>{"use strict";a.d(t,{default:()=>u});var s=a(5155),n=a(2115);let i=e=>{let{commands:t,downloads:a}=e;return(0,s.jsxs)("div",{className:"hidden md:block w-1/3 bg-gray-900 text-white p-4 overflow-scroll",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Network"}),(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left pr-2",children:"Name"}),(0,s.jsx)("th",{className:"text-left pr-2",children:"Status"}),(0,s.jsx)("th",{className:"text-left pr-2",children:"Type"})]})}),(0,s.jsx)("tbody",{children:a.map((e,t)=>(0,s.jsxs)("tr",{className:"200"===e.status?"bg-green-800":"bg-gray-400",children:[(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.name}),(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.status}),(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.type})]},t))})]})]}),t.length?(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-semibold mb-2",children:"nd-javascript stream"}),(0,s.jsx)("div",{className:"bg-gray-800 p-2 overflow-x-auto whitespace-nowrap",children:t.map((e,t)=>(0,s.jsx)("div",{className:"py-1 border-b border-gray-700 last:border-b-0",children:e},t))})]}):null]})},r=n.forwardRef((e,t)=>{let{title:a="NDJavaScript Emulator - Please load a page",content:n,className:r="",commands:l,downloads:o,url:c}=e;return(0,s.jsx)("div",{className:"w-full border border-gray-300 rounded-lg shadow-lg overflow-hidden ".concat(r),children:(0,s.jsxs)("div",{className:"flex h-[calc(60vh-8rem)]",children:[(0,s.jsxs)("div",{className:"flex flex-col w-full md:w-2/3",children:[(0,s.jsxs)("div",{className:"bg-gray-200 px-4 py-2 flex items-center",children:[(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),(0,s.jsx)("div",{className:"ml-4 text-sm font-medium text-gray-700 flex-grow text-center",children:a})]}),(0,s.jsx)("div",{className:"bg-white border-t border-b border-gray-300 px-4 py-2",children:(0,s.jsx)("div",{className:"bg-gray-100 rounded px-3 py-1 text-sm text-gray-800",children:c||"https://ndjavascript.cdaringe.com/"})}),(0,s.jsx)("div",{ref:t,className:"emulator-main bg-white flex-grow overflow-auto ",children:n})]}),(0,s.jsx)(i,{commands:l,downloads:o})]})})});r.displayName="BrowserEmulator";let l=e=>{let{step:t,code:a,type:n,name:i,description:r}=e;return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-2",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Step ",t+1," - ",i]}),(0,s.jsxs)("div",{className:"step relative",children:[(0,s.jsx)("div",{className:"bg-gray-100 p-4 pt-6 rounded mb-4",children:(0,s.jsx)("code",{className:"text-sm",children:a})}),(0,s.jsx)("pre",{className:"ml-1 block text-xs absolute top-[-0.5rem] rounded-lg bg-gray-300 p-1",children:(0,s.jsx)("code",{children:n})})]}),r]})},o=()=>{let[e,t]=(0,n.useState)({x:150,y:150}),[a,i]=(0,n.useState)({x:150,y:180}),[r,l]=(0,n.useState)({x:150,y:220}),[o,c]=(0,n.useState)({x:150,y:50}),[d,p]=(0,n.useState)(null),m=e=>()=>{p(e)},h=()=>{p(null)};return(0,s.jsx)("div",{children:(0,s.jsxs)("svg",{width:"300",height:"300",viewBox:"0 0 300 300",onMouseMove:e=>{var a;if(!d)return;let s=e.currentTarget,n=s.createSVGPoint();n.x=e.clientX,n.y=e.clientY;let r=n.matrixTransform(null===(a=s.getScreenCTM())||void 0===a?void 0:a.inverse());switch(d){case"nose":t({x:r.x,y:r.y});break;case"mustache":i({x:r.x,y:r.y});break;case"chin":l({x:r.x,y:r.y});break;case"hat":c({x:r.x,y:r.y})}},onMouseUp:h,onMouseLeave:h,children:[(0,s.jsx)("rect",{x:o.x-50,y:o.y,width:"100",height:"30",fill:"red",onMouseDown:m("hat"),style:{cursor:"move"}}),(0,s.jsx)("circle",{cx:"150",cy:"150",r:"100",fill:"#ffdbac"}),(0,s.jsx)("circle",{cx:"120",cy:"120",r:"10",fill:"black"}),(0,s.jsx)("circle",{cx:"180",cy:"120",r:"10",fill:"black"}),(0,s.jsx)("circle",{cx:e.x,cy:e.y,r:"15",fill:"#ffb6c1",onMouseDown:m("nose"),style:{cursor:"move"}}),(0,s.jsx)("rect",{x:a.x-40,y:a.y,width:"80",height:"10",fill:"brown",onMouseDown:m("mustache"),style:{cursor:"move"}}),(0,s.jsx)("path",{d:"M ".concat(r.x-40," ").concat(r.y," Q ").concat(r.x," ").concat(r.y+20," ").concat(r.x+40," ").concat(r.y),fill:"none",stroke:"black",strokeWidth:"2",onMouseDown:m("chin"),style:{cursor:"move"}})]})})};var c=a(2669),d=a(5687),p=a(3755);let m=e=>e.getBoundingClientRect().height,h=e=>{let{targetRef:t}=e,[a,i]=(0,n.useState)(!1),{type:r}=(0,p.MM)(),l=(0,p.lW)();return(0,n.useEffect)(()=>{let e=()=>{let e=t.current&&m(t.current);null!=e&&e<140?i(!0):i(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("deviceorientation",e)}},[t,r,l.height,l.width]),a?(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Viewport Too Small"}),(0,s.jsxs)("p",{className:"mb-4",children:["Please rotate your device or use a larger screen to view this content. (",m(t.current),")"]})]})}):null},u=()=>{let e=(0,n.createRef)(),t=(0,n.createRef)(),[a,i]=(0,n.useState)(0),[p,m]=(0,n.useState)("NDJavaScript Emulator - Follow steps below to begin"),[u,x]=(0,n.useState)(""),[y,b]=(0,n.useState)(""),[g,v]=(0,n.useState)([]),[w,j]=(0,n.useState)([]);(0,n.useEffect)(()=>{if("1"!==new URL(window.location.href).searchParams.get("auto"))return;let t=setTimeout(()=>{let t=e.current;t&&t.click()},10);return()=>clearTimeout(t)},[e]);let f=[{name:"Start loading a page",description:"Simulate starting a page load. On large viewports, you'll see the network request in the simulated devtools",type:"user-action",code:"GET https://ndjavascript.cdaringe.com/",execute:()=>{x("https://ndjavascript.cdaringe.com/"),j(e=>[...e,{name:"ndjavascript.cdaringe.com",status:null,type:""}])}},{name:"Page stream begins",description:(0,s.jsxs)(s.Fragment,{children:["The HTTP handshake will succeed, and we are now streaming the page instructions. Specifically, instead of a"," ",(0,s.jsx)("pre",{className:"inline",children:"content-type: text/html"}),", we have a stream of"," ",(0,s.jsx)("pre",{className:"inline",children:"content-type: application/nd-javascript"}),"!"]}),type:"event",code:"GET https://ndjavascript.cdaringe.com/",execute:()=>{j([{name:"ndjavascript.cdaringe.com",status:"200",type:"nd-javascript"}])}},{name:"Set page title",description:(0,s.jsxs)(s.Fragment,{children:["Here we see our first nd-javascript command in our HTTP stream. Historically, we would use HTML to set a title, a la"," ",(0,s.jsx)("pre",{className:"inline",children:"<title>some boring page</title>"}),". Who needs HTML!? We have JavaScript!"]}),type:"application/nd-javascript",code:'document.title = "Super Morio Adventure"',execute:()=>{m("Super Morio Adventure"),v(e=>[...e,'document.title = "Super Morio Adventure"'])}},(()=>{let e="var style=document.createElement('style'); style.textContent='...'; document.head.appendChild(styleElement);";return{name:"Set initial styles",description:"Immediately inline some styles. We want to see something while the rest of our program streams in.",type:"application/nd-javascript",code:e,execute:()=>{b(e=>"\n            ".concat(e,"\n            <style>\n              .emulator-main {\n                background-color: lightblue;\n                width: 100%;\n                height: 100%;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n              }\n            </style>\n          ")),v(t=>[...t,e])}}})(),(()=>{let e='var m = document.createElement("main"); document.body.appendChild(m); /* create SVG face, append it */';return{name:"Create initial DOM nodes",code:e,description:"Create the initial DOM nodes for the page. Again, we used to use HTML for this. We could even continue to do so! However, our application doesn't deal in HTML--it deals in JavaScript, including the window and its APIs! Once content is on the screen, it is not immediately interactable. If a proposal like this were ever be adopted, it is not yet clear when interactability would be granted. Nonetheless, we have not bound behavior yet--just visual nodes.",type:"application/nd-javascript",execute:()=>{let t=(0,d.F0)((0,s.jsx)(o,{}));b(e=>"".concat(e,"<main><div id='root'>").concat(t,"</div></main>\n        ")),v(t=>[...t,e])}}})(),{name:"Start downloading styles",description:"Perhaps our application needs some external CSS. Sure--go grab it! We used to use <link /> for such an operation.",type:"application/nd-javascript",code:'import("styles.css", { assert: { type: "css" } })',execute:()=>{j(e=>[...e,{name:"styles.css",status:null,type:"text/css"}]),v(e=>[...e,'import("styles.css", { assert: { type: "css" } })'])}},(()=>{let e='import("./super-morio").then(() => boot()))';return{name:"Start downloading assets",description:"We are streaming nd-javascript because we are fundamentally building an application, not a simple document. Thus, let us fetch the javascript powering our interactive application. For small applications, it may be common to not make external requests at all, and instead continue stream in code within this open stream.",type:"application/nd-javascript",code:e,execute:()=>{j(e=>[...e,{name:"super-morio.js",status:null,type:"javascript"}]),v(t=>[...t,e])}}})(),(()=>{let e="const meta = document.createElement('meta'); meta.name = 'description'; meta.content = 'This is a tutorial for the application/nd-javascript MIME type.';";return{name:"Set page metadata",description:"We want bots and crawlers to know what this application is about--prepare metadata for them.",type:"application/nd-javascript",code:e,execute:()=>{v(t=>[...t,e])}}})(),{name:"Event: CSS loaded",type:"event",description:"This event is fired when the CSS file has been loaded. We make it a descrete step in this tutorial so you can observe the effects.",code:"stylesheet#onLoad",execute:()=>{j(e=>e.map(e=>("styles.css"===e.name&&(e.status="200"),e))),b(e=>"<style>\n            .emulator-main {\n              width: 100%;\n              height: 100%;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n\n              background-image: url('super-morio.webp');\n              background-size: calc(4% + 200px) calc(4% + 200px);\n              background-repeat: repeat;\n            }\n          </style>\n          ".concat(e,"\n        "))}},(()=>{let e='const boot = () => ReactDOM.hydrateRoot(document.getElementById("root"), <SuperMorioFace />)';return{name:"React hydration",description:"Prepare a boot function. This function will be invoked per the above code when our remote javascript finishes loading.",type:"application/nd-javascript",code:e,execute:()=>{v(t=>[...t,e])}}})(),{name:"Event: JS loaded",type:"event",description:(0,s.jsxs)(s.Fragment,{children:["This event is fired when the JS file has been loaded. Notice that in the current state, the devtools show the JS file as a gray color, thus still loading. Also observe that the face in the GUI is non interactable. Let us simulate the JS file loading. Afterwards, the boot function will have completed and the app should be interactable!"," ",(0,s.jsxs)("b",{children:["Press Next and then play with Super Morio","'","s face!"]})]}),code:"importScript#onLoad",execute:()=>{j(e=>e.map(e=>("super-morio.js"===e.name&&(e.status="200"),e))),setTimeout(()=>{let e=document.getElementById("root");(0,c.hydrateRoot)(e,(0,s.jsx)(n.StrictMode,{children:(0,s.jsx)(o,{})}))},50)}}],N=()=>{a<f.length&&(f[a].execute(),i(e=>e+1),setTimeout(()=>{let e=document.querySelectorAll(".step");e[a+1]&&e[a+1].scrollIntoView({behavior:"smooth",block:"end"})},10))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{targetRef:t}),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,s.jsx)("div",{className:"w-full bg-gray-100",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"pt-12 pb-4",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"application/nd-javascript tutorial"}),(0,s.jsx)("p",{className:"text-xl text-gray-700 mb-4",children:"This tutorial demonstrates how the proposed application/nd-javascript MIME type works. It simulates a stream of newline-delimited JavaScript statements and shows how they build & update a web application."}),(0,s.jsx)("p",{className:"mb-4",children:"application/nd-javascript itself is not the interesting part of this demonstration. Avoiding usage of text/html is the interesting part. Sadly, because this capability does not actually exist in browsers, the demonstration is only faked. Whether a real implementation uses application/binary, application/wasm, or some other similar MIME--any or all would be welcome. application/nd-javascript is used for simplicity and because it has parity with existing behavior supported by browsers for text/html."}),(0,s.jsxs)("p",{className:"mb-4",children:[(0,s.jsx)("b",{children:"Why do this at all?"})," In many applications, our executables generate DOM. Why is it then, that we must also generate HTML, distribute complex artifacts,only to then switch back to generating DOM in the browser? Can we not just generate DOM from the start? HTML is wonderful, but there is no need for it, in the server or in the browser, if the browser simply would allow us. Converting from ","DOM => HTML => DOM"," adds complexity to our applications and also does not give us full control of our application!"]}),(0,s.jsx)("p",{className:"mb-4",children:(0,s.jsxs)("b",{children:["Let","'","s explore a HTML-free web application load. "]})})]})})}),(0,s.jsx)("div",{className:"sticky top-0 z-10 w-full bg-gray-100",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 border border-b-gray-200 relative ",children:(0,s.jsx)(r,{ref:t,title:p,content:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:y}})}),commands:g,downloads:w,url:u})})}),(0,s.jsx)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-24",children:(0,s.jsx)("div",{children:f.map((t,n)=>n<=a?(0,s.jsxs)("div",{className:"mb-4 last:mb-0 pt-4 first:pt-0 border-t first:border-t-0 border-gray-200",children:[(0,s.jsx)(l,{step:n,name:t.name,type:t.type,code:t.code,description:t.description}),n===a&&n<f.length&&(0,s.jsx)("div",{className:"float-end mt-1",children:(0,s.jsx)("button",{ref:e,onClick:N,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next"})})]},n):null)})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[690,390,829,441,517,358],()=>t(9562)),_N_E=e.O()}]);