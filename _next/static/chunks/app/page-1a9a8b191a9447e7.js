(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9562:(e,t,a)=>{Promise.resolve().then(a.bind(a,6211))},6211:(e,t,a)=>{"use strict";a.d(t,{default:()=>b});var s=a(5155),n=a(2115);let i=e=>{let{commands:t,downloads:a}=e;return(0,s.jsxs)("div",{className:"hidden md:block w-1/3 bg-gray-900 text-white p-4 overflow-scroll",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Network"}),(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-left pr-2",children:"Name"}),(0,s.jsx)("th",{className:"text-left pr-2",children:"Status"}),(0,s.jsx)("th",{className:"text-left pr-2",children:"Type"})]})}),(0,s.jsx)("tbody",{children:a.map((e,t)=>(0,s.jsxs)("tr",{className:"200"===e.status?"bg-green-800":"bg-gray-400",children:[(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.name}),(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.status}),(0,s.jsx)("td",{className:"whitespace-nowrap",children:e.type})]},t))})]})]}),t.length?(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-semibold mb-2",children:"nd-javascript stream"}),(0,s.jsx)("div",{className:"bg-gray-800 p-2 overflow-x-auto whitespace-nowrap",children:t.map((e,t)=>(0,s.jsx)("div",{className:"py-1 border-b border-gray-700 last:border-b-0",children:e},t))})]}):null]})},r=n.forwardRef((e,t)=>{let{title:a="NDJavaScript Emulator - Please load a page",content:n,className:r="",commands:o,downloads:l,url:c}=e;return(0,s.jsx)("div",{className:"w-full border border-gray-300 rounded-lg shadow-lg overflow-hidden ".concat(r),children:(0,s.jsxs)("div",{className:"flex h-[calc(60vh-8rem)]",children:[(0,s.jsxs)("div",{className:"flex flex-col w-full md:w-2/3",children:[(0,s.jsxs)("div",{className:"bg-gray-200 px-4 py-2 flex items-center",children:[(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),(0,s.jsx)("div",{className:"ml-4 text-sm font-medium text-gray-700 flex-grow text-center",children:a})]}),(0,s.jsx)("div",{className:"bg-white border-t border-b border-gray-300 px-4 py-2",children:(0,s.jsx)("div",{className:"bg-gray-100 rounded px-3 py-1 text-sm text-gray-800",children:c||"https://ndjavascript.cdaringe.com/"})}),(0,s.jsx)("div",{ref:t,className:"emulator-main bg-white flex-grow overflow-auto ",children:n})]}),(0,s.jsx)(i,{commands:o,downloads:l})]})})});r.displayName="BrowserEmulator";let o=e=>{let{step:t,code:a,type:n,name:i,description:r}=e;return(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-2 break-words",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Step ",t+1," - ",i]}),(0,s.jsxs)("div",{className:"step relative",children:[(0,s.jsx)("div",{className:"bg-gray-100 p-4 pt-6 rounded mb-4 break-words",children:(0,s.jsx)("code",{className:"text-sm",children:a})}),(0,s.jsx)("pre",{className:"ml-1 block text-xs absolute top-[-0.5rem] rounded-lg bg-gray-300 p-1",children:(0,s.jsx)("code",{children:n})})]}),r]})},l=()=>{let[e,t]=(0,n.useState)({x:150,y:150}),[a,i]=(0,n.useState)({x:150,y:180}),[r,o]=(0,n.useState)({x:150,y:220}),[l,c]=(0,n.useState)({x:150,y:50}),[d,h]=(0,n.useState)(null),[m,u]=(0,n.useState)({x:150,y:150}),[p,x]=(0,n.useState)({x:-30,y:-30}),[y,b]=(0,n.useState)({x:30,y:-30}),w=e=>t=>{t.preventDefault(),h(e)},g=()=>{h(null)},v=e=>{var a;if(!d)return;let s=e.currentTarget,n=s.createSVGPoint(),r="touches"in e?e.touches[0].clientX:e.clientX,l="touches"in e?e.touches[0].clientY:e.clientY;n.x=r,n.y=l;let h=n.matrixTransform(null===(a=s.getScreenCTM())||void 0===a?void 0:a.inverse());switch(d){case"nose":t({x:h.x,y:h.y});break;case"mustache":i({x:h.x,y:h.y});break;case"chin":o({x:h.x,y:h.y});break;case"hat":c({x:h.x,y:h.y});break;case"face":u({x:h.x,y:h.y});break;case"leftEye":x({x:h.x-m.x,y:h.y-m.y});break;case"rightEye":b({x:h.x-m.x,y:h.y-m.y})}};return(0,s.jsx)("div",{children:(0,s.jsxs)("svg",{width:"300",height:"300",viewBox:"0 0 300 300",onMouseMove:v,onTouchMove:v,onMouseUp:g,onTouchEnd:g,onMouseLeave:g,children:[(0,s.jsx)("circle",{cx:m.x,cy:m.y,r:"100",fill:"#ffdbac",onMouseDown:w("face"),onTouchStart:w("face"),style:{cursor:"move"}}),(0,s.jsx)("circle",{cx:m.x+p.x,cy:m.y+p.y,r:"10",fill:"black",onMouseDown:w("leftEye"),onTouchStart:w("leftEye"),style:{cursor:"move"}}),(0,s.jsx)("circle",{cx:m.x+y.x,cy:m.y+y.y,r:"10",fill:"black",onMouseDown:w("rightEye"),onTouchStart:w("rightEye"),style:{cursor:"move"}}),(0,s.jsx)("circle",{cx:e.x,cy:e.y,r:"15",fill:"#ffb6c1",onMouseDown:w("nose"),onTouchStart:w("nose"),style:{cursor:"move"}}),(0,s.jsx)("rect",{x:a.x-40,y:a.y,width:"80",height:"10",fill:"brown",onMouseDown:w("mustache"),onTouchStart:w("mustache"),style:{cursor:"move"}}),(0,s.jsx)("path",{d:"M ".concat(r.x-40," ").concat(r.y," Q ").concat(r.x," ").concat(r.y+20," ").concat(r.x+40," ").concat(r.y),fill:"none",stroke:"black",strokeWidth:"2",onMouseDown:w("chin"),onTouchStart:w("chin"),style:{cursor:"move"}}),(0,s.jsx)("rect",{x:l.x-50,y:l.y,width:"100",height:"30",fill:"red",onMouseDown:w("hat"),onTouchStart:w("hat"),style:{cursor:"move"}})]})})};var c=a(2669),d=a(5687),h=a(3755);let m=e=>e.getBoundingClientRect().height,u=e=>{let{targetRef:t}=e,[a,i]=(0,n.useState)(!1),{type:r}=(0,h.MM)(),o=(0,h.lW)();return(0,n.useEffect)(()=>{let e=()=>{let e=t.current&&m(t.current);null!=e&&e<105?i(!0):i(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("deviceorientation",e)}},[t,r,o.height,o.width]),a?(0,s.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Viewport Too Small"}),(0,s.jsxs)("p",{className:"mb-4",children:["Please rotate your device or use a larger screen to view this content. (",m(t.current),")"]})]})}):null},p=e=>{let{children:t}=e;return(0,s.jsx)("pre",{className:"inline text-wrap break-words",children:t})},x=(0,s.jsxs)(s.Fragment,{children:[" ",(0,s.jsx)(p,{children:"application/nd-javascript"})," "]}),y=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold mb-4",children:[x," tutorial"]}),(0,s.jsxs)("div",{className:"text-xl text-gray-700 mb-4",children:["This tutorial demonstrates how the ",x," MIME"," type could work. It simulates a stream of newline-delimited JavaScript statements and shows how they build & update a web application."]}),(0,s.jsx)("a",{href:"#demo-start",className:"block text-blue-500 mb-4",children:"Jump right to the demo."}),(0,s.jsxs)("div",{className:"mb-4",children:[x," ",(0,s.jsx)("i",{children:"itself"})," is not interesting.",x," is a means to discuss evolving beyond ",(0,s.jsx)(p,{children:"text/html"})," "," for transmitting applications."," Sadly, because this capability does not actually exist in browsers, the following demonstration is faked. Whether a real implementation uses",(0,s.jsx)(p,{children:" application/binary"}),", ",(0,s.jsx)(p,{children:"application/wasm"}),", or another similar MIME--any or all would be welcome. ",x," is used for simplicity and because of its proximity to existing browser APIs."]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("b",{children:"Why do this at all?"})," For many applications, we build executables whose core function is an interplay of generating DOM, responding to the user, and updating the DOM. Consider web application runtimes, such as"," ",(0,s.jsx)(p,{children:"react"}),", ",(0,s.jsx)(p,{children:"svelte"}),", ",(0,s.jsx)(p,{children:"solid"}),", etc. These toolkits are for building applications--and ultimately, DOM nodes. Indeed, they can generate HTML, but that is an important"," ",(0,s.jsx)("i",{children:" secondary "}),"feature. Their primary objective is to make application development easier by applying tools that result in a predictable and maintainable DOM. Thus, if we have established that our primary application toolkits excel at ",(0,s.jsx)(p,{children:"DOM-ops"}),", why is it then that we commonly burden ourselves with also generating HTML? Most senior web-devs have all heard of ",(0,s.jsx)(p,{children:"VirtualDOM"})," by this point. Why is there no"," ",(0,s.jsx)(p,{children:"VirtualHTML"})," (/s)? For server side rendering, why do we use DOM-first libraries, convert to HTML, then post-hydration, go right back to DOM? The answer is that we have to, not that we want to. Can we cut out the HTML middleman and operate with DOM from start to finish? HTML is wonderful DSL for documents, but for applications it is pure overhead. For applications, our community would likely operate on DOM directly if the browser would allow us. Imagine if all of the power backing browser","'","s HTML engines were actually APIs that we could tap into at boot time!"]}),(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsxs)("b",{children:["Let","'","s explore a HTML-free web application load!"]})})]}),b=()=>{let e=(0,n.createRef)(),t=(0,n.createRef)(),[a,i]=(0,n.useState)(0),[h,m]=(0,n.useState)("NDJavaScript Emulator - Follow steps below to begin"),[p,x]=(0,n.useState)(""),[b,w]=(0,n.useState)(""),[g,v]=(0,n.useState)([]),[f,j]=(0,n.useState)([]);(0,n.useEffect)(()=>{if("1"!==new URL(window.location.href).searchParams.get("auto"))return;let t=setTimeout(()=>{let t=e.current;t&&t.click()},10);return()=>clearTimeout(t)},[e]);let N=[{name:"Start loading a page",description:"Simulate starting a page load. On large viewports, you'll see the network request in the simulated devtools",type:"user-action",code:"GET https://ndjavascript.cdaringe.com/",execute:()=>{x("https://ndjavascript.cdaringe.com/"),j(e=>[...e,{name:"ndjavascript.cdaringe.com",status:null,type:""}])}},{name:"Page stream begins",description:(0,s.jsx)(s.Fragment,{children:"Let us simulate a succussful HTTP handshake, and begin streaming nd-javascript statements. Assume that a newline transform stream is present."}),type:"event",code:"GET https://ndjavascript.cdaringe.com/",execute:()=>{j([{name:"ndjavascript.cdaringe.com",status:"200",type:"nd-javascript"}])}},{name:"Set page title",description:(0,s.jsxs)(s.Fragment,{children:["Here we see our first nd-javascript line in our HTTP stream. Historically, we would use HTML to set a title, a la"," ",(0,s.jsx)("pre",{className:"inline break-words text-wrap",children:"<title>My Cool Page</title>"}),". Who needs HTML!? We have JavaScript! Observe the title update on",'"Next"',"."]}),type:"application/nd-javascript",code:'document.title = "Super Morio Adventure"',execute:()=>{m("Super Morio Adventure"),v(e=>[...e,'document.title = "Super Morio Adventure"'])}},(()=>{let e="var style=document.createElement('style'); style.textContent='...'; document.head.appendChild(styleElement);";return{name:"Set initial styles",description:"Immediately inline some styles. We want to see something while the rest of our program streams in.",type:"application/nd-javascript",code:e,execute:()=>{w(e=>"\n            ".concat(e,"\n            <style>\n              .emulator-main {\n                background-color: lightblue;\n                width: 100%;\n                height: 100%;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n              }\n            </style>\n          ")),v(t=>[...t,e])}}})(),(()=>{let e='var m = document.createElement("main"); document.body.appendChild(m); /* create SVG face, append it */';return{name:"Create initial DOM nodes",code:e,description:"Create the initial DOM nodes for the page. Again, we used to use HTML for this. We could even continue to do so! However, our application doesn't deal in HTML--it deals in JavaScript, including the window and its APIs! Once content is on the screen, it is not immediately interactable. If a proposal like this were ever be adopted, it is not yet clear when interactability would be granted. Nonetheless, we have no interaction defined yet--just visual nodes.",type:"application/nd-javascript",execute:()=>{let t=(0,d.F0)((0,s.jsx)(l,{}));w(e=>"".concat(e,"<main><div id='root'>").concat(t,"</div></main>\n        ")),v(t=>[...t,e])}}})(),{name:"Start downloading styles",description:"Perhaps our application needs some external CSS. Sure--go grab it! We used to use <link /> for such an operation. Now, perhaps we use `import()` statements!",type:"application/nd-javascript",code:'import("styles.css", { assert: { type: "css" } })',execute:()=>{j(e=>[...e,{name:"styles.css",status:null,type:"text/css"}]),v(e=>[...e,'import("styles.css", { assert: { type: "css" } })'])}},(()=>{let e='import("./super-morio").then(() => boot()))';return{name:"Start downloading assets",description:"We are streaming nd-javascript because we are fundamentally building an application, not a simple document. Thus, let us fetch the javascript powering our interactive application. For small applications, it may be common to not make external requests at all, and instead continue stream in code within this open stream. Here, let's pretend that we have a CDN asset we actually want to use. This step kicks off the async download.",type:"application/nd-javascript",code:e,execute:()=>{j(e=>[...e,{name:"super-morio.js",status:null,type:"javascript"}]),v(t=>[...t,e])}}})(),(()=>{let e="const meta = document.createElement('meta'); meta.name = 'description'; meta.content = 'This is a tutorial for the application/nd-javascript MIME type.';";return{name:"Set page metadata",description:"We want bots and crawlers to know what this application is about--prepare metadata for them.",type:"application/nd-javascript",code:e,execute:()=>{v(t=>[...t,e])}}})(),{name:"Event: CSS loaded",type:"event",description:"This event is fired when the CSS file has been loaded. We make it a descrete step in this tutorial so you can observe the effects.",code:"stylesheet#onLoad",execute:()=>{j(e=>e.map(e=>("styles.css"===e.name&&(e.status="200"),e))),w(e=>"<style>\n            .emulator-main {\n              width: 100%;\n              height: 100%;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n\n              background-image: url('super-morio.webp');\n              background-size: calc(4% + 200px) calc(4% + 200px);\n              background-repeat: repeat;\n            }\n          </style>\n          ".concat(e,"\n        "))}},(()=>{let e='const boot = () => ReactDOM.hydrateRoot(document.getElementById("root"), <SuperMorioFace />)';return{name:"React hydration",description:"Prepare a boot function. This function will be invoked per the above code when our remote javascript finishes loading.",type:"application/nd-javascript",code:e,execute:()=>{v(t=>[...t,e])}}})(),{name:"Event: JS loaded",type:"event",description:(0,s.jsxs)(s.Fragment,{children:["This event is fired when the JS file has been loaded. Notice that in the current state, the devtools show the JS file as a gray color, thus still loading. Also observe that the face in the GUI is non interactable. Let us simulate the JS file loading. Afterwards, the boot function will have completed and the app should be interactable!"," ",(0,s.jsxs)("b",{children:["Press Next and then play with Super Morio","'","s face!"]})]}),code:"importScript#onLoad",execute:()=>{j(e=>e.map(e=>("super-morio.js"===e.name&&(e.status="200"),e))),setTimeout(()=>{let e=document.getElementById("root");(0,c.hydrateRoot)(e,(0,s.jsx)(n.StrictMode,{children:(0,s.jsx)(l,{})}))},50)}}],S=()=>{a<N.length&&(N[a].execute(),i(e=>e+1),setTimeout(()=>{let e=document.querySelectorAll(".step");e[a+1]&&e[a+1].scrollIntoView({behavior:"smooth",block:"end"})},10))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u,{targetRef:t}),(0,s.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,s.jsx)("div",{className:"w-full bg-gray-100",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"pt-12 pb-4",children:(0,s.jsx)(y,{})})})}),(0,s.jsx)("div",{id:"demo-start",className:"sticky top-0 z-10 w-full bg-gray-100",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 border border-b-gray-200 relative ",children:(0,s.jsx)(r,{ref:t,title:h,content:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:b}})}),commands:g,downloads:f,url:p})})}),(0,s.jsx)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-24",children:(0,s.jsx)("div",{children:N.map((t,n)=>n<=a?(0,s.jsxs)("div",{className:"mb-4 last:mb-0 pt-4 first:pt-0 border-t first:border-t-0 border-gray-200",children:[(0,s.jsx)(o,{step:n,name:t.name,type:t.type,code:t.code,description:t.description}),n===a&&n<N.length&&(0,s.jsx)("div",{className:"float-end mt-1",children:(0,s.jsx)("button",{ref:e,onClick:S,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Next"})})]},n):null)})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[690,390,829,441,517,358],()=>t(9562)),_N_E=e.O()}]);